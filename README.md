# üöÄ Node Agent ‚Äî –£–º–Ω—ã–π –∞–≥–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ Linux üöÄ

![Node Agent Banner](https://em-content.zobj.net/source/microsoft-teams/363/rocket_1f680.png)

---

## ü¶æ –ß—Ç–æ —Ç–∞–∫–æ–µ Node Agent?

**Node Agent** ‚Äî —ç—Ç–æ –ª–µ–≥–∫–∏–π –∏ –º–æ—â–Ω—ã–π –∞–≥–µ–Ω—Ç –¥–ª—è Linux/Ubuntu —Å–µ—Ä–≤–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–π:

- üö¶ –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ FastAPI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è  
- üåê –†–∞–±–æ—Ç–∞–µ—Ç —Å GOST –¥–ª—è –≥–∏–±–∫–æ–≥–æ TCP/UDP-–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è  
- ü´Ä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç heartbeat: –¥–µ—Ä–∂–∏—Ç —Å–≤—è–∑—å —Å –º–∞—Å—Ç–µ—Ä-–Ω–æ–¥–æ–π (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)  
- ‚òÅÔ∏è –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –¥–µ–ø–ª–æ–∏—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä—è–º–æ –∏–∑ –≤–∞—à–µ–π —É–ø—Ä–∞–≤–ª—è—é—â–µ–π –ø–∞–Ω–µ–ª–∏  

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

> üêß **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Ubuntu 18.04/20.04/22.04+, root-–¥–æ—Å—Ç—É–ø

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É:**
   ```bash
   git clone https://github.com/Lunatik-cyber/Astro_NodeAgent.git
   cd Astro_NodeAgent
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π-—Å–∫—Ä–∏–ø—Ç (–æ–Ω —Å–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –Ω—É–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏):**
   ```bash
   chmod +x deploy.sh
   sudo ./deploy.sh
   ```

   –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   ```bash
   NODE_UUID=my-uuid-123 MASTER_URL=http://1.2.3.4/api/node/heartbeat sudo ./deploy.sh
   ```

3. **–ì–æ—Ç–æ–≤–æ! –ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:**
   ```
   http://<ip-—Å–µ—Ä–≤–µ—Ä–∞>:8000/
   ```

---

## üõ†Ô∏è –ü—Ä–∏–º–µ—Ä —Å—É–ø–µ—Ä-–±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ deploy.sh

```bash
git clone https://github.com/Lunatik-cyber/Astro_NodeAgent.git
cd Astro_NodeAgent
chmod +x deploy.sh
sudo NODE_UUID=$(cat /proc/sys/kernel/random/uuid) MASTER_URL="http://master-node/api/node/heartbeat" ./deploy.sh
```

---

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è   | –û–ø–∏—Å–∞–Ω–∏–µ                                           | –ü—Ä–∏–º–µ—Ä                                        |
|--------------|----------------------------------------------------|-----------------------------------------------|
| `NODE_UUID`  | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–∞—à–µ–π –Ω–æ–¥—ã                | `c0ffee-babe-42-1337`                         |
| `MASTER_URL` | URL –º–∞—Å—Ç–µ—Ä-–Ω–æ–¥—ã –¥–ª—è heartbeat –∏ –¥–µ–ø–ª–æ–µ–≤            | `http://master-node/api/node/heartbeat`       |

---

## üì° API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞–≥–µ–Ω—Ç–∞

| Endpoint                | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ                                    |
|-------------------------|-------|---------------------------------------------|
| `/ping`                 | GET   | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞                 |
| `/forwarding/list`      | GET   | –°–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–∞–≤–∏–ª –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è         |
| `/forwarding/status`    | GET   | –°—Ç–∞—Ç—É—Å —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥–∞                          |
| `/forwarding/add`       | POST  | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥–∞                |
| `/forwarding/remove`    | POST  | –£–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ                             |
| `/forwarding/edit`      | POST  | –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ                            |
| `/forwarding/deploy`    | POST  | –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–ø–∏—Å–∫–æ–º            |
| `/run_cmd`              | POST  | –í—ã–ø–æ–ª–Ω–∏—Ç—å shell-–∫–æ–º–∞–Ω–¥—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ ‚ö†Ô∏è        |

---

## üî• –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ

```bash
curl -X POST http://localhost:8000/forwarding/add \
  -H "Content-Type: application/json" \
  -d '{"ip": "1.2.3.4", "port": 8080, "redirect_port": 80, "protocol": "tcp"}'
```

### üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ

```bash
curl -X POST http://localhost:8000/forwarding/remove \
  -H "Content-Type: application/json" \
  -d '{"ip": "1.2.3.4", "port": 8080, "redirect_port": 80, "protocol": "tcp"}'
```

### ‚ôªÔ∏è –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞

```bash
curl -X POST http://localhost:8000/forwarding/deploy \
  -H "Content-Type: application/json" \
  -d '[
    {"ip": "1.2.3.4", "port": 8080, "redirect_port": 80, "protocol": "tcp"},
    {"ip": "5.6.7.8", "port": 9090, "redirect_port": 443, "protocol": "udp"}
  ]'
```

### üñ•Ô∏è –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å

```bash
curl http://localhost:8000/forwarding/status
```

---

## üß¨ –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–∞–≤–∏–ª–∞ (JSON)

```json
{
  "ip": "1.2.3.4",
  "port": 8080,
  "redirect_port": 80,
  "protocol": "tcp"
}
```
- **port** –∏ **redirect_port** ‚Äî —Ç–æ–ª—å–∫–æ –æ—Ç 1 –¥–æ 65535  
- **protocol** ‚Äî —Ç–æ–ª—å–∫–æ "tcp" –∏–ª–∏ "udp"  
- –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ tcp+udp –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –ø–æ—Ä—Ç–∞  

---

## ü´Ä Heartbeat

–ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç heartbeat —Ä–∞–∑ –≤ 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ MASTER_URL:

```json
{
  "node_uuid": "your-node-uuid"
}
```
> –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å —Ü–µ–Ω—Ç—Ä–∞.

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å firewall/ACL –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ API  
- –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –ø–æ—Ä—Ç 8000 –Ω–∞—Ä—É–∂—É –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏!  
- –ê–≥–µ–Ω—Ç —Ç—Ä–µ–±—É–µ—Ç root-–¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏ –∏ –ø–æ—Ä—Ç–∞–º–∏  

---

## ü§ñ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ª–∞–π—Ñ—Ö–∞–∫–∏

- üß© –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ tcp, –∏ udp –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –ø–æ—Ä—Ç–∞!
- ü¶∫ –í—Å—Ç—Ä–æ–µ–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- üèÉ‚Äç‚ôÇÔ∏è GOST –≤—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ (–Ω–∏–∫–∞–∫–∏—Ö systemd/systemctl)
- üïµÔ∏è‚Äç‚ôÇÔ∏è –ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å ad-hoc shell-–∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ `/run_cmd` (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

> üí° **Node Agent ‚Äî –≤–∞—à —à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π –Ω–æ–∂ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π –Ω–∞ Linux!**
